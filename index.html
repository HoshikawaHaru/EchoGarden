<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport"
        content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
  <!-- ğŸ iOS å…¨å±ä¸çŠ¶æ€æ  -->
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="theme-color" content="rgba(0,0,0,0)">
  <title>Echo Garden</title>

  <link rel="stylesheet" href="css/main.css"><!-- ä¿ç•™ä½ ä¹‹å‰æˆåŠŸçš„æ ·å¼ -->
  <link rel="apple-touch-icon" sizes="512x512" href="assets/icons/icon512.png">
  <link rel="icon" href="assets/icons/icon512.png" type="image/png">
  <script src="js/main.js" defer></script>

  <!-- ä»…æ–°å¢/è¦†ç›–å¿…è¦æ ·å¼ï¼šèƒŒæ™¯å±‚ã€åŒé¡µå®¹å™¨ã€Dockã€‚ä¸è¦åŠ¨ .app-iconï¼ -->
  <style>
    html, body {
      margin: 0; padding: 0;
      height: 100%; width: 100%;
      overflow: hidden;
      background: #000; /* èƒŒæ™¯å›¾æœªåŠ è½½æ—¶çš„å…œåº•è‰² */
    }
    /* èƒŒæ™¯å›¾å±‚ï¼šå›ºå®šé“ºæ»¡ï¼Œå¤„äºé¡µé¢æœ€åº•ä½†ä¸æ˜¯è´Ÿ z-indexï¼ˆé¿å…è¢«æ ¹èƒŒæ™¯ç›–æ‰ï¼‰ */
    #bg-layer{
      position: fixed; inset: 0;
      width: 100%; height: 100%;
      object-fit: cover;
      z-index: 0;
      pointer-events: none; user-select: none;
    }

    #theme-toggle{
      position: fixed;
      top: calc(env(safe-area-inset-top) + 8px);
      right: 14px;
      z-index: 3;
    }

    /* åŒé¡µæ¨ªæ»‘å®¹å™¨ï¼ˆä¸»å± + å³æ»‘é¡µï¼‰ */
    #container{
      position: relative;
      z-index: 1;                 /* åœ¨èƒŒæ™¯ä¹‹ä¸Š */
      display: flex;
      width: 200%;
      min-height: 100dvh;         /* iOS åŠ¨æ€è§†å£å•ä½ï¼Œé˜²æ­¢æ•´ä½“ä¸Šç§» */
      transition: transform .4s ease;
    }
    .page{
      width: 50%;
      min-height: 100dvh;
      display: grid;
      place-items: center;
      /* ç»™åº•éƒ¨ç•™å‡º Dock ç©ºé—´ */
      padding-bottom: calc(env(safe-area-inset-bottom) + 110px);
      /* é¡¶éƒ¨å®‰å…¨åŒº */
      padding-top: calc(env(safe-area-inset-top) + 10px);
    }
    /* åˆ‡åˆ°å³æ»‘é¡µ */
    #container.swiped{ transform: translateX(-50%); }

    /* Dockï¼ˆå”¯ä¸€ç£¨ç ‚ç»ç’ƒï¼‰ */
    #dock{
      position: fixed;
      left: 50%;
      bottom: calc(env(safe-area-inset-bottom) + 20px);
      transform: translateX(-50%);
      z-index: 2;
      width: 230px; height: 74px;
      border-radius: 26px;
      background: rgba(255,255,255,0.2);
      -webkit-backdrop-filter: blur(20px) saturate(1.1);
      backdrop-filter: blur(20px) saturate(1.1);
      display: flex; align-items: center; justify-content: space-around;
    }
    #dock .dock-item{
      display: flex; flex-direction: column; align-items: center;
      gap: 4px;
    }
    #dock .dock-item img{ width: 40px; height: 40px; border-radius: 10px; }
    #dock .dock-item p{ color:#fff; font-size:12px; margin:0; }
  </style>
</head>

<body>
  <!-- èƒŒæ™¯ï¼šä¿æŒä½ ä¹‹å‰æˆåŠŸçš„å®ç° -->
  <img id="bg-layer" src="assets/bg/night.jpeg" alt="background" draggable="false">

  <button id="theme-toggle" aria-label="åˆ‡æ¢ä¸»é¢˜">ğŸŒ—</button>

  <!-- åŒé¡µå®¹å™¨ -->
  <div id="container">
    <!-- é¦–é¡µï¼šå‰”é™¤â€œæ¶ˆæ¯/è®¾ç½®â€ï¼Œå…¶å®ƒä¿æŒåŸæ ·å¼ï¼ˆç”± css/main.css æ§åˆ¶ï¼‰ -->
    <main class="page" id="home">
      <div class="app-grid">
        <div class="app-icon" data-app="diary"><img src="assets/icons/diary.png"><p>æ—¥è®°</p></div>
        <div class="app-icon" data-app="forum"><img src="assets/icons/forum.png"><p>è®ºå›</p></div>
        <div class="app-icon" data-app="words"><img src="assets/icons/words.png"><p>å•è¯</p></div>
        <div class="app-icon" data-app="memo"><img src="assets/icons/memo.png"><p>å¿ƒå£°</p></div>
      </div>
    </main>

    <!-- å³æ»‘é¡µï¼šåªæ”¾â€œå¡”ç½—â€ï¼Œä½ç½®æ’åœ¨é¦–é¡µâ€œæ¶ˆæ¯â€å¯¹åº”çš„ç¬¬ä¸€æ ¼ -->
    <section class="page" id="right">
      <div class="app-grid">
        <div class="app-icon" data-app="tarot"><img src="assets/icons/tarot.png"><p>å¡”ç½—</p></div>
      </div>
    </section>
  </div>

  <!-- å›ºå®š Dockï¼ˆç£¨ç ‚ç»ç’ƒï¼‰ï¼šåªæ”¾æ¶ˆæ¯ & è®¾ç½® -->
  <div id="dock">
    <div class="dock-item" data-app="message"><img src="assets/icons/message.png"><p>æ¶ˆæ¯</p></div>
    <div class="dock-item" data-app="settings"><img src="assets/icons/settings.png"><p>è®¾ç½®</p></div>
  </div>

  <!-- App å®¹å™¨ï¼ˆä¿æŒä½ çš„ç»“æ„ï¼‰ -->
  <section id="app-container" style="display:none;"></section>

  <script>
    // ç®€æ˜“å·¦å³æ»‘åŠ¨
    let startX = 0;
    const container = document.getElementById('container');
    addEventListener('touchstart', e => startX = e.touches[0].clientX, {passive:true});
    addEventListener('touchend',   e => {
      const endX = e.changedTouches[0].clientX;
      if (startX - endX > 80)  container.classList.add('swiped');    // å³æ»‘åˆ°å¡”ç½—
      if (endX - startX > 80)  container.classList.remove('swiped'); // å·¦æ»‘å›ä¸»é¡µ
    }, {passive:true});
  </script>
</body>
</html>
