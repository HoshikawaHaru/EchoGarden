/* ========= 视口与安全区变量 ========= */
:root{
  --safe-top: env(safe-area-inset-top, 0px);
  --safe-bottom: env(safe-area-inset-bottom, 0px);
  --safe-left: env(safe-area-inset-left, 0px);
  --safe-right: env(safe-area-inset-right, 0px);
}

/* ========= 全屏背景处理 ========= */
html {
  margin: 0;
  padding: 0;
  width: 100%;
  height: 100%;
  background-color: #000;
}

/* === 背景图像层（使用 <img> 避免 Safari 背景缩放问题） === */
#bg-layer {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  /* 关键：延伸到安全区域之外，覆盖底部黑边 */
  height: calc(100% + env(safe-area-inset-bottom, 0px));
  object-fit: cover; /* 保持比例填充，不变形 */
  object-position: center center;
  z-index: -1;
  pointer-events: none;
  user-select: none;
}

/* body 固定全屏，防止滚动和黑边 */
body{
  margin: 0; 
  padding: 0;
  width: 100%;
  /* 关键：延伸到底部安全区之外 */
  height: calc(100% + env(safe-area-inset-bottom, 0px));
  position: fixed;
  top: 0;
  left: 0;
  overflow: hidden;
  background: #000; /* 兜底背景色 */
  color: #fff;
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
}

/* ========= 主屏容器：精确填满视口 ========= */
#homescreen{
  width: 100%;
  /* 使用 100vh 而不是 100%，确保填满可视区域 */
  min-height: 100vh;
  box-sizing: border-box;
  padding-top: max(var(--safe-top), 20px);
  /* 底部 padding 确保内容不被 Home Indicator 遮挡 */
  padding-bottom: max(var(--safe-bottom), 20px);
  padding-left: max(var(--safe-left), 16px);
  padding-right: max(var(--safe-right), 16px);
  display: flex;
  justify-content: center;
  align-items: center;
  flex-direction: column;
}

/* ========= App 网格 ========= */
.app-grid{
  display: grid;
  grid-template-columns: repeat(4, 80px);
  gap: 24px 16px;
  justify-content: center;
  align-content: center;
}

.app-icon{
  text-align: center;
  color: #fff;
  user-select: none;
  cursor: pointer;
  transition: transform 0.1s ease;
}

.app-icon:active{
  transform: scale(0.95);
}

.app-icon img{
  width: 60px; 
  height: 60px;
  border-radius: 20%;
  backdrop-filter: blur(5px);
  background: rgba(255,255,255,0.1);
  display: block;
  margin: 0 auto;
}

.app-icon p{
  font-size: 11px; 
  margin: 4px 0 0 0;
  text-shadow: 0 1px 3px rgba(0,0,0,0.5);
}

/* ========= 主题切换按钮 ========= */
#theme-toggle{
  position: fixed;
  top: max(12px, var(--safe-top));
  right: max(12px, var(--safe-right));
  z-index: 10;
  background: rgba(255,255,255,0.25);
  color: #fff;
  border: none; 
  border-radius: 50%;
  width: 42px; 
  height: 42px; 
  font-size: 18px;
  backdrop-filter: blur(8px);
  cursor: pointer;
  transition: background 0.3s ease, transform 0.2s ease;
  display: flex;
  align-items: center;
  justify-content: center;
}

#theme-toggle:active{ 
  background: rgba(255,255,255,0.35); 
  transform: scale(0.95); 
}

body.light #theme-toggle{ 
  background: rgba(0,0,0,0.1); 
  color: #000; 
}

/* ========= App 页面容器 ========= */
#app-container{
  position: fixed;
  inset: 0;
  display: none;
  background: rgba(0,0,0,0.9);
  overflow-y: auto;
  padding-top: var(--safe-top);
  padding-bottom: var(--safe-bottom);
  padding-left: var(--safe-left);
  padding-right: var(--safe-right);
  z-index: 100;
}
